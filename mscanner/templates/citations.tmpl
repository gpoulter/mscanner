<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

#* TEMPLATE PARAMETERS
$cite_table -- HTML for citation table
$dataset -- Name of data set
$linkpath -- Include JS and CSS remotely at this location
$mode -- 'input' or 'output'
$timestamp -- time.time() for start of the operation
$num_citations -- Number of citations in the report
$prev_file/this_file/next_file -- Names of files to link to
*#

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>

  <title>
    #if $mode == "input"
    Input Citations for $dataset
    #else
    Result Citations for $dataset
    #end if
  </title>

  #if $getVar("linkpath", None)
  <script type="text/javascript" src="$linkpath/hider.js"></script>
  <script type="text/javascript" src="$linkpath/fileutils.js"></script>
  <script type="text/javascript" src="$linkpath/citations.js"></script>
  <link rel="stylesheet" type="text/css" href="$linkpath/style.css" />
  #else
  <script type="text/javascript">
    #include raw $_inc("hider.js")
    #include raw $_inc("fileutils.js")
    #include raw $_inc("citations.js")
  </script>
  <style type="text/css">
    #include raw $_inc("style.css")
  </style>
  #end if

</head>

<body>

<div class="header">
  <h1>
    #if $mode == "input"
    Input Citations for $dataset
    #else
    Output Citations for $dataset
    #end if
  </h1>
</div>

<div class="body">

<div class="narrow">

<p>
#if $getVar("prev_file", None)
Previous File: <a href="$prev_file">$prev_file</a>
#end if
#if $getVar("next_file", None)
Next File: <a href="$next_file">$next_file</a>
#end if
</p>

<p>
  This report contains $num_citations citations,
  #if $mode == "input"
  which are input citations (examples of relevant articles) used to train the classifier.
  #else
  which are the results of a query operation (articles which MScanner has classified as relevant).
  #end if
</p>

<fieldset class="cite">

  <legend>Classify citations</legend>

  <input type="button" id="pubmed_all" value="Open all citations in PubMed" /><br />
  <input type="button" id="pubmed_relevant" value="Open relevant citations in PubMed" /><br />

  <p>
    To open only relevant citations in PubMed, you must first click in the 
    "C" column once to mark the citation relevant (<span
    style="background-color:red;color:red;">...</span>)).  
  </p>
  
  <p>    
    You can click again to mark citations as irrelevant (<span
    style="background-color:blue;color:blue;">...</span>). Grey citations (
    <span style="background-color:lightgrey;color:lightgrey;">...</span>)
    mean "not yet been manually classified".  
  </p>
</fieldset>


<fieldset class="cite">

  <legend>Save and load manual classifications</legend>

  <p>To save and load classifications, this file must be opened
  from disk (e.g. after having been saved using "save page as").
  You may also have to "Allow blocked content" if Internet Explorer
  or Mozilla Firefox are blocking the scripts in the file 
  (since local scripts can read and write a files on the disk like
  a normal program, which can be risky).</p>
  
  File name to use:<input type="file" size="50" id="fname" />
  <br />
  <input type="button" id="save_tags" value="Save classifications to file" /><br/>
  <input type="button" id="load_tags" value="Load classifications from file" /><br/>
  <input type="button" id="append_html" value="Append citations from HTML file"/>

  <p>The first two buttons save or load the manual classifications
  to/from a CSV file (that can be opened in Excel).</p>
  
  <p>The third button only works in Firefox (required feature is not
  supported in Internet Explorer). It expects an HTML file (like this one), 
  and will add that file's table of citations to the bottom of this one.</p>
  
</fieldset>

## Filter citations by regex

<fieldset class="cite"> 

<legend>Filter by title and abstract</legend> 

<input type="text" size="35" id="filter"/> 

<input type="button" id="do_filter" value="Filter Citations" /> 

<input type="button" id="clear_filter" value="Clear Filter" />

<p>Uses a case-insensitive <a
href="http://www.javascriptkit.com/jsref/regexp.shtml">regular expression</a>
to filter the citations by title and abstract. Given "X" we test
RegExp("X","i") on the title and abstract of each citation. To find "rat" as a
whole word, use "\brat\b" (specifies that "rat" must have word boundaries on
either side). Clearing the filter will show all citations. </p>

</fieldset>

<fieldset class="cite">

  <legend>Filter by publication date</legend>
  
  <p>Only list citations published between
  <input type="text" size="4" id="yearstart" value="1900"/> and
  <input type="text" size="4" id="yearend" value="2020"/> inclusive.
  <input type="button" id="do_year_filter" value="Filter"/>
  </p>

</fieldset>

</div><!--class=narrow-->

## Actual citations

$cite_table

</div><!--class=body-->

<div class="footer">
                                               
</div>

</body>

</html>