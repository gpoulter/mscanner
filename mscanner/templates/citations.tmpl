<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

#* TEMPLATE PARAMETERS
$cite_table -- HTML for citation table
$dataset -- Name of data set
$linkpath -- Include JS and CSS remotely at this location
$mode -- 'input' or 'output'
$timestamp -- time.time() for start of the operation
$num_citations -- Number of citations in the report
$prev_file/this_file/next_file -- Names of files to link to
*#

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>

  <title>
    #if $mode == "input"
    Input Citations for $dataset
    #else
    Result Citations for $dataset
    #end if
  </title>

  #if $getVar("linkpath", None)
  <script type="text/javascript" src="$linkpath/hider.js"></script>
  <script type="text/javascript" src="$linkpath/fileutils.js"></script>
  <script type="text/javascript" src="$linkpath/citations.js"></script>
  <link rel="stylesheet" type="text/css" href="$linkpath/style.css" />
  #else
  <script type="text/javascript">
    #include raw $_inc("hider.js")
    #include raw $_inc("fileutils.js")
    #include raw $_inc("citations.js")
  </script>
  <style type="text/css">
    #include raw $_inc("style.css")
  </style>
  #end if

</head>

<body>

<div class="header">
  <h1>
    #if $mode == "input"
    Input Citations for $dataset
    #else
    Output Citations for $dataset
    #end if
  </h1>
</div>

<div class="body">

<div class="narrow">

<p>
#if $getVar("prev_file", None)
Previous File: <a href="$prev_file">$prev_file</a>
#end if
#if $getVar("next_file", None)
Next File: <a href="$next_file">$next_file</a>
#end if
</p>

<p>
  This report contains $num_citations citations,
  #if $mode == "input"
  which are input citations (examples of relevant articles) used to train the classifier.
  #else
  which are the results of a query operation (articles which MScanner has classified as relevant).
  #end if
</p>

<p>To use the save/load features, you will have to save the file as a
local HTML file.  When you open the HTML file, Internet Explorer will say
at the top "To help protect your security, Internet Explorer has restricted 
this webpage from running scripts or ActiveX controls that could access your 
computer".  You will have to "Allow blocked content" before save/load or 
filtering of results will work.</p>

<fieldset class="cite">

  <legend>Manage Classifications</legend>
  
  Select a file name:<input type="file" size="80" id="fname" />
  <br />
  <input type="button" id="save_tags" value="Save classifications to file" /><br/>
  <input type="button" id="load_tags" value="Load classifications from file" /><br/>
  <input type="button" id="pubmed_relevant" value="Open relevant citations in PubMed" /><br/>
  <input type="button" id="pubmed_all" value="Open all citations in PubMed" /><br/>
  <input type="button" id="append_html" value="Append citations from HTML file"/>
  
  <p>
    Classify citations as irrelevant (<span
    style="background-color:blue;color:blue;">...</span>) by clicking
    once in the "C" column, or relevant (<span
    style="background-color:red;color:red;">...</span>) by clicking twice.
    Gray citations (<span
    style="background-color:lightgray;color:lightgray;">...</span>)
    have not yet been manually classified.  Use the buttons above to
    save/load these classifications.  The third button will open
    citations that have been marked relevant in pubmed.
  </p>
  
  <p>
    Use the buttons above to save and load the manual classifications
    to/from disk in CSV format.  Since remote pages are not able to
    access local files, this page must first be saved as an HTML file
    and opened locally for the save/load feature to work.
  </p>
  
</fieldset>

## Filter citations by regex

<fieldset class="cite"> 

<legend>Filter Citations</legend> 

<input type="text" size="50" id="filter" onkeypress="return noenter()"/> 

<input type="button" id="do_filter" value="Filter Citations" /> 

<input type="button" id="clear_filter" value="Clear Filter" />

<p>Case-insensitive <a
href="http://www.javascriptkit.com/jsref/regexp.shtml">regular expression</a>
filter. Clearing the filter will show all citations. Given text "X" we test
RegExp("X","i") on the title and abstract of each citation. To
find "rat" as a whole word, use "\brat\b" (specifies that "rat" must
have word boundaries on either side).</p>

</fieldset>

<p>Only list citations published between
<input type="text" size="4" id="yearstart" value="1900"/> and
<input type="text" size="4" id="yearend" value="2020"/> inclusive.
<input type="button" id="do_year_filter" value="Filter"/>
</p>

</div><!--class=narrow-->

## Actual citations

$cite_table

</div><!--class=body-->

<div class="footer">
                                               
</div>

</body>

</html>