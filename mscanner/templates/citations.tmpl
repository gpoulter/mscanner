<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

#* Table of citations

cite_table -- HTML for citation table

dataset -- Name of data set

linkpath -- Include JS and CSS remotely at this location

mode -- 'input' or 'output'

timestamp -- time.time() for start of the operation

report_length  -- Number of citations in the report

filename -- Name of the current file (e.g. 'results_03.html')

filelist -- List of names of all HTML files in the set
*#

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>

  <title>
    #if $mode == "input"
    Input Citations for $dataset
    #else
    Result Citations for $dataset
    #end if
  </title>

  #if $getVar("linkpath", None)
  <script type="text/javascript" src="$linkpath/hider.js"></script>
  <script type="text/javascript" src="$linkpath/fileutils.js"></script>
  <script type="text/javascript" src="$linkpath/citations.js"></script>
  <link rel="stylesheet" type="text/css" href="$linkpath/style.css" />
  #else
  <script type="text/javascript">
    #include raw $_inc("hider.js")
    #include raw $_inc("fileutils.js")
    #include raw $_inc("citations.js")
  </script>
  <style type="text/css">
    #include raw $_inc("style.css")
  </style>
  #end if

</head>

<body>

<div id="header">
  <h1>
    #if $mode == "input"
    Input Citations for $dataset
    #else
    Output Citations for $dataset
    #end if
  </h1>
</div>

<div id="body">

<div class="narrow">

<p id="navigation">
Navigation: 
#set cur_idx = $filelist.index($filename)

#if $cur_idx > 0
<a href="$filelist[$cur_idx-1]">Previous</a>&nbsp;
#end if

#for idx in range($cur_idx)
<a href="$filelist[$idx]">#echo $idx+1#</a>&nbsp;
#end for

<b><a href="$filename">#echo $cur_idx+1#</a></b>&nbsp;

## These are files which can be used by the result-appender
<span id="appendable_files">
#for idx in range($cur_idx+1, len($filelist))
<a href="$filelist[$idx]">#echo $idx+1#</a>&nbsp;
#end for
</span>

#if len($filelist) > $cur_idx+1
<a href="$filelist[$cur_idx+1]">Next</a>
#end if
</p>

<p>
  This report contains <span id="report_length">$report_length</span> citations.
  #if $mode == "input"
  These are the input citations, used to train MScanner.
  #else if $mode == "output"
  These are result citations.
  #end if
</p>

<div class="control" id="script_warning">

  <p>
    The script which hides this paragraph has not run. If the page is taking
    a long time to load, consider downloading the zip file instead. If there is
    an alert saying that there is blocked content, select "Allow blocked content"
    to enable the scripts.
  </p>
  
</div>

<div class="control" id="no_save_load_div">

  <p> 
    This file is being viewed online. By opening a local copy of the file it
    will be possible to save to file and load from file the manual
    classifications made by clicking once or twice in the "C" column. 
  </p>

</div>

<div class="control" id="filter_div">

  <form id="filter_form">
  <table>
  <tr>
  <th>Title contains</th>
  <td><input type="text" size="30" id="title_regex" /></td>
  </tr>
  
  <tr>
  <th>Title/abstract contains</th>
  <td><input type="text" size="30" id="title_abstract_regex" /></td>
  </tr>
  
  <tr>
  <th>Title/abstract does not contain</th>
  <td><input type="text" size="30" id="exclude_regex" /></td>
  </tr>
  
  <tr>
  <th>Year of publication is between</th>
  <td><input type="text" size="3" id="year_min" value="1900" /> and
  <input type="text" size="3" id="year_max" value="2020" /></td>
  </tr>
  
  <tr>
  <th>Abbreviated journal contains</th>
  <td><input type="text" size="20" id="journal_regex" /></td>
  </tr>
  </table>
  </form>  

  <p>
    <button id="do_filter">Filter visible</button>&nbsp;
    <button id="clear_filter">Show all citations</button>&nbsp;
    <button class="toggle" id="toggle_h_filter">Help</button>
  </p>

  <div class="help" id="h_filter">
  
    <p>The first button will hide any visible citations that do not
    match the filter (it will not unhide anything already hidden). The
    second button unhides all citations.</p>
  
    <p>The filters are case-insensitive <a
    href="http://www.javascriptkit.com/jsref/regexp.shtml">regular
    expressions</a>. These will locate substrings, but have many additional
    features. For example, "rat" matches both "rat" and "aberration",
    but "\brat\b" will only match "rat" ("\b" means "word boundary").</p>
    
  </div>

</div> 

<div class="control" id="pubmed_div">

  <button id="open_pubmed_all">Open visible in PubMed</button>&nbsp;
  <button id="open_pubmed_relevant">Open relevant in Pubmed</button>&nbsp;
  <button class="toggle" id="toggle_h_open">Help</button>

  <div class="help" id="h_open">

    <p>Opens PubMed in a new window, for the citations that are visible below.
    The second button instead opens those citations which have been marked
    relevant by clicking once in "C" column (colours changes to red <span
    style="background-color:red;color:red;">...</span>)).</p>
    
    <p>Clicking a second time explicitly marks the citation as irrelevant (<span
    style="background-color:blue;color:blue;">...</span>). Grey citations ( <span
    style="background-color:lightgrey;color:lightgrey;">...</span>) are not 
    manually classified".</p>
    
  </div>
  
</div>

<div class="control" id="save_load_div">

  <button id="save_tags">Save Classifications</button>&nbsp;
  <button id="load_tags">Load Classifications</button>&nbsp;
  <button class="toggle" id="toggle_h_save_load">Help</button>
  
  <div class="help" id="h_save_load">
    #set save_target = $filename.namebase+".csv"
    <p>
      These buttons will save or load classifications (the marks in the "C"
      column as to whether a citation is relevant or irrelevant) to a file
      called <a id="save_target" href="$save_target">$save_target</a>.
    </p>
  </div>

</div>

<div class="control" id="append_results_div">

  <button id="append_results">Append next result file</button>&nbsp;
  Next up is: <a id="next_to_append" href=""></a>.&nbsp;
  <button class="toggle" id="toggle_h_append">Help</button>
  
  <div class="help" id="h_append">
    <p>Append citations from later results files to the bottom of this one.</p>
  </div>
  
</div>

</div><!--class=narrow-->

<h2>Table of citations</h2>

$cite_table

</div><!--class=body-->

<div id="footer">
                                               
</div>

</body>

</html>