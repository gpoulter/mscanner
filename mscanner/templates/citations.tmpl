<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

#* Table of citations

cite_table -- HTML for citation table

dataset -- Name of data set

linkpath -- Include JS and CSS remotely at this location

mode -- 'input' or 'output'

timestamp -- time.time() for start of the operation

report_length  -- Number of citations in the report

filename -- Name of the current file (e.g. 'results_03.html')

filelist -- List of names of all HTML files in the set
*#

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>

  <title>
    #if $mode == "input"
    Input Citations for $dataset
    #else
    Result Citations for $dataset
    #end if
  </title>

  #if $getVar("linkpath", None)
  <script type="text/javascript" src="$linkpath/hider.js"></script>
  <script type="text/javascript" src="$linkpath/fileutils.js"></script>
  <script type="text/javascript" src="$linkpath/citations.js"></script>
  <link rel="stylesheet" type="text/css" href="$linkpath/style.css" />
  #else
  <script type="text/javascript">
    #include raw $_inc("hider.js")
    #include raw $_inc("fileutils.js")
    #include raw $_inc("citations.js")
  </script>
  <style type="text/css">
    #include raw $_inc("style.css")
  </style>
  #end if

</head>

<body>

<div id="header">
  <h1>
    #if $mode == "input"
    Input Citations for $dataset
    #else
    Output Citations for $dataset
    #end if
  </h1>
</div>

<div id="body">

<div class="narrow">

<p id="navigation">
Navigation: 
#set cur_idx = $filelist.index($filename)

#if $cur_idx > 0
<a href="$filelist[$cur_idx-1]">Previous</a>&nbsp;
#end if

#for idx in range($cur_idx)
<a href="$filelist[$idx]">#echo $idx+1#</a>&nbsp;
#end for

<b><a href="$filename">#echo $cur_idx+1#</a></b>&nbsp;

## These are files which can be used by the result-appender
<span id="appendable_files">
#for idx in range($cur_idx+1, len($filelist))
<a href="$filelist[$idx]">#echo $idx+1#</a>&nbsp;
#end for
</span>

#if len($filelist) > $cur_idx+1
<a href="$filelist[$cur_idx+1]">Next</a>
#end if
</p>

<p>
  This report contains <span id="report_length">$report_length</span> citations.
  #if $mode == "input"
  These are the input citations, used to train MScanner.
  #else if $mode == "output"
  These are result citations.
  #end if
</p>

<div id="script_warning">

  <h2>Dynamic content is disabled</h2>

  <p>
  Either the page is busy loading (can take a while over slow
  connections - consider downloading the zip file), or the
  browser is blocking the scripts. If the browser is warning about
  scripts select "Allow blocked content" to enable the scripts.
  </p>
  
</div>

<div id="pubmed_div">

  <h2>Open citations in PubMed</h2>

  <button id="open_pubmed_all">All citations</button>&nbsp;
  <button id="open_pubmed_relevant">Only relevant citations</button>

  <p>To open only relevant citations in PubMed, first mark some citations as
  relevant by clicking on them once in "C" column (<span
  style="background-color:red;color:red;">...</span>)). </p>
  
  <p>Clicking a second time explicitly marks the citation as irrelevant (<span
  style="background-color:blue;color:blue;">...</span>). Grey citations ( <span
  style="background-color:lightgrey;color:lightgrey;">...</span>) are not 
  manually classified".</p>
  
</div>

<div id="no_save_load_div">

  <h2>Saving/loading of classifications is disabled</h2>
  
  <p>This file is being viewed online.  If the file were opened
  locally from the hard drive,  then classifications (markings
  of which citations in the file have been marked relevant or irrelevant) 
  could be saved or loaded.  To use that feature, either "save page as",
  or downloading the zip file containing all of the results pages.</p>

</div>

<div id="save_load_div">

  <h2>Saving and loading classifications</h2>  
    
  <button id="save_tags">Save</button>
  <button id="load_tags">Load</button>
  
  #set save_target = $filename.namebase+".csv"
  
  <p>These buttons will save or load classifications (the marks in the "C"
  column as to whether a citation is relevant or irrelevant) to a file
  called <a id="save_target" href="$save_target">$save_target</a>
  in the same directory as this HTML file one.</p>

</div>

<div id="append_results_div">

  <h2>Appending later result files</h2>
  
  <p>
  <button id="append_results">Append results</button>
  (next file to append is <a id="next_to_append" href=""></a>)
  </p>
  
  <p>Append citations from later results files to the bottom of this one.</p>
  
</div>

## Filter citations by regex

<div id="abstract_filter_div">

  <h2>Filter by title/abstract</h2>
  
  <input type="text" size="35" id="filter"/> 
  
  <input type="button" id="do_filter" value="Filter Citations" /> 
  
  <input type="button" id="clear_filter" value="Clear Filter" />
  
  <p>Uses a case-insensitive <a
  href="http://www.javascriptkit.com/jsref/regexp.shtml">regular expression</a>
  to filter the citations by title and abstract. Given "X" we test
  RegExp("X","i") on the title and abstract of each citation. To find "rat" as a
  whole word, use "\brat\b" (specifies that "rat" must have word boundaries on
  either side). Clearing the filter will show all citations.</p>

</div>

<div id="year_filter_div">

  <h2>Filter by year of publication</h2>
  
  <p>Of visible citations, only show those published between
  <input type="text" size="3" id="yearstart" value="1900"/> and
  <input type="text" size="3" id="yearend" value="2020"/>.
  <button id="do_year_filter">Filter</button>
  </p>

</div> 

</div><!--class=narrow-->

<h2>Table of citations</h2>

## Actual citations

$cite_table

</div><!--class=body-->

<div id="footer">
                                               
</div>

</body>

</html>