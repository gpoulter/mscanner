#extends page

#def title
MScanner Output
#end def

#def contents

#import time

$getVar("errors", "")

<div class="narrow">

#if $getVar("nodelete", None) is not None
  <p>Cannot delete <q>$target</q>: $nodelete</p>
#end if

#if $getVar("deleted_location", None) is not None
  <p>Have deleted the task <q>$target</q> from $deleted_location.</p>
#end if

#if len($donetasks) == 0
  <p>There is no output currently avaiable.</p>
#else
  <p>Links to results for $len($donetasks) tasks. Results using the "hide"
  feature are not listed.</p>
#end if

</div><!--class=narrow-->

#if len($donetasks) > 0
  
<form id="output" action="" method="post">

  <table>
    <thead>
      <tr>
        <th>Selection</th>
        <th>Timestamp</th>
        <th>Operation</th>
        <th>Link to Output</th>
      </tr>
    </thead>
    <tbody>
      #for d in $donetasks
      <tr>
        <td class="del">
          <input type="radio" name="dataset" value="$d.dataset">
        </td>
        <td class="timestamp">
          $time.strftime("%Y/%m/%d %H:%M:%S UTC", $time.gmtime($d.timestamp))
        </td>
        <td class="operation">
          $d.operation
        </td>
        <td class="dataset">
          <a href="/static/output/$d.dataset/">$d.dataset</a>
        </td>
      </tr>
      #end for
    </tbody>
  </table>
  
  <div class="narrow">
    <p>
      Download selected as a zip file (0.5-2 megabytes, 
      <input type="checkbox" name="omit_mesh" checked="checked"> omit term list to save 300k):
      <button type="submit" name="operation" value="download">download</button>
    </p>
    <p>
      Delete selected using deletion code: 
      <input name="delcode" type="text" size="10">
      <button type="submit" name="operation" value="delete">delete</button>
    </p>
  </div>

</form>

#end if have_donetasks

#end def contents
