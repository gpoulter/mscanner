<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

#* Index to the query outputs

linkpath -- Include JS and CSS remotely at this location

rc -- RCStorage object with configuration parameters

lowest_score -- Score of lowest-scoring article

num_results -- Number of results

timestamp -- time.time() for start of the operation

best_tfidfs -- List of termid, tfidf, (term, termtype), score, pos, neg for
               those terms with the highest TF.IDF scores.

notfound_pmids -- List of PubMed IDs that were not found in the database
(passed to invalid.tmpl)
*#

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>

  <title>MScanner query results: $rc.dataset</title>

  #if $getVar("linkpath", None) 
  <script type="text/javascript" src="$linkpath/hider.js"></script>
  <link rel="stylesheet" type="text/css" href="$linkpath/style.css" />
  #else
  <script type="text/javascript">
    #include raw $_inc("hider.js")
  </script>
  <style type="text/css">
    #include raw $_inc("style.css")
  </style>
  #end if
  
  <script type="text/javascript">
  window.onload = function() {
    make_toggles();
  }
  </script>
  
</head>

#def help(name)
<td>
  #if $name is not None
  <button class="toggle" id="toggle_$name">?</button>
  #end if
</td>
#end def

#def hr(name, value)
<tr id="$name" class="help">
  <td colspan="3">
    $value
  </td>
</tr>
#end def

<body>

<div id="header">
 <h1>MScanner query results: $rc.dataset</h1>
</div>

<div id="body">

<div class="narrow">

 <h2>Result Properties</h2>

 <table id="results">
   <colgroup>
     <col class="label"></col>
     <col class="value"></col>
     <col class="help"></col>
   </colgroup>
   <thead>
     <tr>
       <th>Name</th>
       <th>Value</th>
       <th>Help</th>
     </tr>
   </thead>
  <tbody>

  <tr>
    <th>Timestamp</th>
    #import time
    <td>$time.strftime("%Y/%m/%d %H:%M:%S UTC", $time.gmtime($timestamp))</td>
    $help("h_timestamp")
  </tr>
  $hr("h_timestamp", "When the data set was created")

  <tr>
    <th>File written at</th>
    #import time
    <td>$time.strftime("%Y/%m/%d %H:%M:%S UTC", $time.gmtime())</td>
    $help("h_written")
  </tr>
  $hr("h_written", "When this index file was written (at the end of the query)")

  #if $rc.pseudocount is not None
  <tr>
    <th>Pseudocount</th>
    <td>$rc.pseudocount</td>
    $help("h_pseudocount")
  </tr>
  $hr("h_pseudocount", """Prior added to the number of occurrences
  of each term to regularise the estimated occurrence probabilities.""")
  #end if

  <tr>
    <th>Result limit</th>
    <td>$rc.limit</td>
    $help("h_limit")
  </tr>
  $hr("h_limit", """The maximum number of results.""")

  <tr>
    <th>Score threshold</th>
    <td>$rc.threshold</td>
    $help("h_threshold")
  </tr>
  $hr("h_threshold", """The minimum score which may be included in
  the results""")

  <tr>
    <th>Number of results</th>
    <td>$num_results</td>
    $help(None)
  </tr>

  <tr>
    <th>Lowest scoring result</th>
    <td>#echo "%.5f" % $lowest_score #</td>
    $help(None)
  </tr>

  <tr>
    <th>Input PubMed IDs</th>
    <td><a href="$rc.report_input_scores">$rc.report_input_scores</a></td>
    $help("h_positives")
  </tr>
  $hr("h_positives", """PubMed IDs for the examples.""")

  <tr>
    <th>MeSH Scores (CSV)</th>
    <td><a href="$rc.report_term_scores">$rc.report_term_scores</a></td>
    $help("h_csv")
  </tr>
  $hr("h_csv", """CSV spreadsheet with the support scores for the
  features (MeSH terms and ISSNs).  The number of positive and
  negative occurrences and pseudocount are also included, as these
  go into calculating the support score.""")

  <tr>
    <th>Result scores</th>
    <td><a href="$rc.report_result_scores">$rc.report_result_scores</a></td>
    $help("h_result_scores")
  </tr>
  $hr("h_result_scores", """Text file with the result PubMed IDs
  ranked by decreasing score (score is also listed).""")

  <tr>
    <th>Input citations</th>
    <td><a href="$rc.report_input_citations">$rc.report_input_citations</a></td>
    $help("h_input_citations")
  </tr>
  $hr("h_input_citations", """Web page with the example citations
  provided as input.  They are ranked by score, so if there are
  examples which don't fit with the majority they should be near
  the bottom.""")

  <tr>
    <th>Result citations</th>
    <td><a href="$rc.report_result_citations">$rc.report_result_citations</a></td>
    $help("h_result_citations")
  </tr>
  $hr("h_result_citations", """Web page with the results of the
  query, including links to NCBI, titles and abstracts.  Warning:
  file may be large.""")

 </tbody>
 </table>

  #include $_inc("features.tmpl")

  #if $getVar("best_tfidfs", None)
  <h2>Features with high TF-IDF</h2>
  
  <p>These features are the most suitable for use in keyword searches
  to retrieve this set of articles.  Features with TF-IDF
  above 0.2 or 0.3 are more useful. </p>
  
  <table>
  <thead>
  <tr>
  <th>TF-IDF</th>
  <th>Type</th>
  <th>Term</th>
  <th>Term ID</th>
  <th>Score</th>
  <th>Pos</th>
  <th>Neg</th>
  </tr>
  </thead>
  #for termid, tfidf, (term, termtype), score, pos, neg in $best_tfidfs:
  <tr>
  <td>#echo "%.2f"%$tfidf#</td>
  <td>$termtype</td>
  <td>$term</td>
  <td>$termid</td>
  <td>#echo "%.2f"%$score#</td>
  <td>$pos</td>
  <td>$neg</td>
  </tr>
  #end for termid
  </table>
  #end if tfidf
  
  #include $_inc("invalid.tmpl")
  
</div><!--narrow-->  
  
</div><!--body-->

<div id="footer">
                                               
</div>

</body>

</html>